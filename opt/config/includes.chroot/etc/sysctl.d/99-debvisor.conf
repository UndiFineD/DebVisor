# DebVisor baseline kernel hardening
# These settings are intended to be safe defaults on Debian servers
# and should not conflict with Debian's own secure defaults.

# Enable IPv4/IPv6 forwarding; DebVisor commonly routes/NATs traffic
# for virtual machines and containers. Operators who do not want the
# host to act as a router can override these settings.
net.ipv4.ip_forward = 1
net.ipv6.conf.all.forwarding = 1

# Ignore source-routed packets
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.default.accept_source_route = 0

# Disable ICMP redirect acceptance
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0

# Enable TCP SYN cookies to help protect against SYN floods
net.ipv4.tcp_syncookies = 1

# Enable reverse path filtering to mitigate IP spoofing
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1

# Optionally log martian packets (spoofed/bad source addresses).
# This can be noisy on some networks; operators can override if needed.
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.default.log_martians = 1
