# Autogenerated by Ansible blocklist role
# IPv4-only blocklist set for DebVisor host firewall.
# This file is included from /etc/nftables.conf via /etc/nftables.d/*.conf.

table inet debvisor_blocklist {
  set blocked_ips {
    type ipv4_addr
    flags interval
    elements = {
{% for ip in effective_blocklist | default([]) %}
      {{ ip }}{{ ',' if not loop.last else '' }}
{% endfor %}
    }
  }

  # This chain is intended to be jumped to from the main input chain,
  # for example: jump debvisor_blocklist_input
  chain debvisor_blocklist_input {
    type filter hook input priority 100; policy accept;
    ip saddr @blocked_ips counter drop
  }
}
