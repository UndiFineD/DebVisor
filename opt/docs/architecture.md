# Architecture\n\nDebVisor is a containers?first, hyper?converged node: it treats\ncontainers and Kubernetes workloads as the default way to run\napplications, with VMs available alongside them when needed.\nUse containers when:\n\n- You are deploying stateless or horizontally scalable services.\n\n- You want Kubernetes-native automation, rolling updates, and self-healing.\n\n- You need fast iteration and simple rollbacks for application code.\n\nUse VMs when:\n\n- You are running legacy or appliance-style workloads that cannot be containerized yet.\n\n- You need strong isolation boundaries or custom guest kernels.\n\n- You are hosting operating-system-level environments (e.g. lab images, special-purpose appliances).\n\n## Base\n\n- Debian minimal (netinst/live-build base; default target release: bookworm)\n\n- English (US) locale, UTC timezone\n\n## Virtualization Layer\n\n- KVM/QEMU + libvirt (daemon + system integration)\n\n- OVMF (UEFI guest firmware) + SeaBIOS (legacy)\n\n- Cockpit (machines/network/storage dashboards)\n\n- Optional LXD (future consideration)\n\n## Storage Layer\n\n- Ceph (MON, MGR, OSD, MDS) for shared storage (CephFS, RBD)\n\n- ZFS for local performance datasets (vm, docker, k8s) - optional or mixed\n\n- LVM2 / mdadm fallback support; xfs, btrfs utilities\n\n## Container & Orchestration Layer\n\n- Docker Engine + Compose plugin (classic workloads)\n\n- Kubernetes: kubeadm, kubelet, kubectl\n\n- Container runtime: containerd (for K8s) + crictl tooling\n\n- CNI default: Calico (Cilium optional future)\n\n- CSI: Ceph CSI (RBD & CephFS) + optional ZFS LocalPV\n\n## Networking\n\n- Primary bridge `br0` for VMs and services\n\n- VLAN / bonding support (future dynamic detection)\n\n- Calico pod network; potential BGP for multi-node expansion\n\n## Management & Automation\n\n- Systemd first?boot service invoking provisioning script\n\n- Cockpit for web-based visualization & control\n\n- Configuration seeded via preseed + profile selection\n\n## Security & Resilience\n\n- Fail2ban, nftables/ufw, unattended upgrades\n\n- Optional rootless Docker mode (future enhancement)\n\n- ZFS scrub + Ceph health checks (timers)\n\n## Expansion (Roadmap)\n\n- Multi-node Ceph and Kubernetes join scripts\n\n- Metrics/observability stack (Prometheus/Grafana)\n\n- Upgrade orchestration (Ansible playbooks)\n