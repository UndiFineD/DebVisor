{
  "version": "1.0.0",
  "last_updated": "2025-11-26T00:00:00Z",
  "blocklist_format_version": "1.0",
  "blocklists": {
    "blocklist-example.txt": {
      "description": "Example blocklist with IPv4 and IPv6 malicious ranges, cloud providers, and geoip entries",
      "sources": [
        "Internal threat intelligence feed",
        "Known malicious ASNs and IP ranges",
        "Cloud provider abuse ranges (example entries)"
      ],
      "sha256": "placeholder-compute-after-generation",
      "size_bytes": 5847,
      "entry_count": 143,
      "last_updated": "2025-11-26T00:00:00Z",
      "entry_types": {
        "ipv4_cidr": 45,
        "ipv4_single": 12,
        "ipv6_cidr": 62,
        "ipv6_single": 24
      },
      "applicable_versions": ["2.0.0", "2.1.0", "2.2.0"],
      "caveats": [
        "IPv6 link-local (fe80::/10) - Use with caution; can break cluster communications if blocked",
        "IPv6 multicast (ff00::/8) - Blocking entire multicast range can break network discovery (ND)",
        "Documentation range (2001:db8::/32) - Safe for labs only, not for production blocking"
      ],
      "categories": [
        "ipv4_known_malicious",
        "ipv4_cloud_providers",
        "ipv6_known_malicious",
        "ipv6_specific_threats",
        "ipv6_link_local_exceptions",
        "ipv6_multicast_restrictions",
        "ipv6_geoip",
        "ipv6_cloud_providers",
        "ipv6_private_ranges"
      ]
    },
    "blocklist-whitelist-example.txt": {
      "description": "Example whitelist with trusted internal networks, DNS/NTP servers, and cluster communication ranges",
      "sources": [
        "Organization internal networks (ULA ranges)",
        "Trusted DNS servers (Google, Cloudflare, Quad9)",
        "Trusted NTP servers",
        "Cluster heartbeat and neighbor discovery addresses"
      ],
      "sha256": "placeholder-compute-after-generation",
      "size_bytes": 6234,
      "entry_count": 143,
      "last_updated": "2025-11-26T00:00:00Z",
      "entry_types": {
        "ipv4_cidr": 38,
        "ipv4_single": 15,
        "ipv6_cidr": 52,
        "ipv6_single": 38
      },
      "applicable_versions": ["2.0.0", "2.1.0", "2.2.0"],
      "caveats": [
        "Link-local range (fe80::/10) - Critical for cluster heartbeats; always whitelist for cluster nodes",
        "Neighbor discovery multicast (ff02::1, ff02::2, ff02::1:ff00:0/104) - Required for IPv6 ND to function",
        "ULA ranges (fc00::/7, fd00::/8) - Organization-specific; adjust for your internal networks"
      ],
      "categories": [
        "ipv4_internal_networks",
        "ipv4_dns_servers",
        "ipv4_ntp_servers",
        "ipv6_internal_networks",
        "ipv6_vendors",
        "ipv6_dns_servers",
        "ipv6_ntp_servers",
        "ipv6_link_local_cluster",
        "ipv6_neighbor_discovery",
        "ipv6_emergency_access",
        "dual_stack_examples"
      ]
    }
  },
  "deployment": {
    "validation": {
      "script": "etc/debvisor/validate-blocklists.sh",
      "checks": [
        "CIDR syntax validation (IPv4/IPv6)",
        "Overlapping range detection",
        "Duplicate entry detection",
        "Whitelist override verification"
      ]
    },
    "integrity": {
      "script": "etc/debvisor/verify-blocklist-integrity.sh",
      "method": "SHA256",
      "on_failure": "abort_deployment"
    },
    "firewall_backends": [
      "nftables (ip and ip6 rules)",
      "iptables (IPv4) + ip6tables (IPv6)",
      "cloud-provider-specific rules (AWS Security Groups, GCP Firewall, Azure NSG)"
    ]
  },
  "performance": {
    "small": {
      "entry_count_max": 10000,
      "memory_per_rule_bytes": 128,
      "estimated_memory_mb": 1.28,
      "typical_lookup_time_us": 50,
      "recommendation": "Minimal overhead; safe for all deployments"
    },
    "medium": {
      "entry_count_max": 50000,
      "memory_per_rule_bytes": 128,
      "estimated_memory_mb": 6.4,
      "typical_lookup_time_us": 75,
      "recommendation": "Monitor firewall rule load; consider segmentation above 30k rules"
    },
    "large": {
      "entry_count_max": 100000,
      "memory_per_rule_bytes": 128,
      "estimated_memory_mb": 12.8,
      "typical_lookup_time_us": 100,
      "recommendation": "Segmentation recommended; use tiered blocking and caching strategies"
    },
    "very_large": {
      "entry_count_max": 1000000,
      "memory_per_rule_bytes": 128,
      "estimated_memory_mb": 128,
      "typical_lookup_time_us": 150,
      "recommendation": "Definitely segment; consider external rule engine or hardware acceleration"
    }
  },
  "versioning": {
    "scheme": "semantic (MAJOR.MINOR.PATCH) with git hash",
    "example": "1.0.0+g1a2b3c4",
    "compatibility": {
      "breaking_changes": "Bump MAJOR version; require operator acknowledgment before deployment",
      "new_features": "Bump MINOR version; safe to auto-deploy in CI",
      "bug_fixes": "Bump PATCH version; safe to auto-deploy in CI"
    }
  }
}
