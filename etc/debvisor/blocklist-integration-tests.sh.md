# Code Issues Report: etc\debvisor\blocklist-integration-tests.sh

Generated: 2025-12-13T17:07:04.262497
Source: etc\debvisor\blocklist-integration-tests.sh

## Issues Summary

Total: 176 issues found

| Line | Column | Tool | Code | Severity | Message |
|------|--------|------|------|----------|---------|
| 1 | 12 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 2 | 43 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 3 | 66 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 4 | 67 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 5 | 42 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 6 | 49 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 7 | 70 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 8 | 68 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 9 | 75 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 10 | 70 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 11 | 33 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 12 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 13 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 14 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 15 | 94 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 16 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 17 | 71 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 18 | 55 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 19 | 59 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 20 | 56 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 21 | 45 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 22 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 23 | 16 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 24 | 37 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 25 | 16 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 26 | 61 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 27 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 28 | 9 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 29 | 67 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 30 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 31 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 32 | 18 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 33 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 34 | 14 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 35 | 20 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 36 | 40 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 37 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 38 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 39 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 40 | 9 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 41 | 17 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 42 | 19 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 43 | 20 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 44 | 18 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 45 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 46 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 47 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 48 | 34 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 49 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 50 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 51 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 52 | 35 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 53 | 19 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 54 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 55 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 56 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 57 | 33 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 58 | 19 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 59 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 60 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 61 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 62 | 36 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 63 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 64 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 65 | 16 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 66 | 38 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 67 | 39 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 68 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 69 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 70 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 71 | 18 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 72 | 25 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 73 | 15 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 74 | 38 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 75 | 50 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 76 | 44 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 77 | 7 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 78 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 79 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 80 | 25 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 81 | 19 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 82 | 44 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 83 | 21 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 84 | 55 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 85 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 86 | 23 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 87 | 57 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 88 | 86 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 89 | 55 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 90 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 91 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 92 | 67 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 93 | 96 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 94 | 55 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 95 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 96 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 97 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 98 | 43 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 99 | 27 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 100 | 42 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 101 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 102 | 64 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 103 | 40 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 104 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 105 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 106 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 107 | 120 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 108 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 109 | 36 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 110 | 61 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 111 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 112 | 7 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 113 | 51 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 114 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 115 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 116 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 117 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 118 | 54 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 119 | 26 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 120 | 52 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 121 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 122 | 24 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 123 | 30 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 124 | 62 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 125 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 126 | 56 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 127 | 34 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 128 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 129 | 109 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 130 | 42 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 131 | 26 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 132 | 7 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 133 | 51 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 134 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 135 | 38 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 136 | 60 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 137 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 138 | 7 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 139 | 69 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 140 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 141 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 142 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 143 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 144 | 43 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 145 | 27 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 146 | 42 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 147 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 148 | 64 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 149 | 40 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 150 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 151 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 152 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 153 | 120 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 154 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 155 | 36 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 156 | 61 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 157 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 158 | 7 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 159 | 51 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 160 | 13 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 161 | 5 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 162 | 2 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 163 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 164 | 58 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 165 | 30 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 166 | 53 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 167 | 1 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 168 | 3 | shellcheck | `1009` | INFO | The mentioned syntax error was in this simple command. |
| 168 | 11 | shellcheck | `1073` | ERROR | Couldn't parse this here document. Fix to allow more checks. |
| 168 | 14 | shellcheck | `1041` | ERROR | Found 'PYEOF' further down, but not on a separate line. |
| 168 | 14 | shellcheck | `1042` | ERROR | Close matches include '  python3  "$TEST_ENV/results/dual-stack-test.json" 2>&1\r' (!= 'PYEOF'). |
| 168 | 14 | shellcheck | `1042` | ERROR | Close matches include '  python3  "$TEST_ENV/results/overlap-test.json" 2>&1\r' (!= 'PYEOF'). |
| 168 | 14 | shellcheck | `1042` | ERROR | Close matches include '  python3  /dev/null 2>&1\r' (!= 'PYEOF'). |
| 168 | 14 | shellcheck | `1042` | ERROR | Close matches include 'PYEOF\r' (!= 'PYEOF'). |
| 168 | 68 | shellcheck | `1017` | ERROR | Literal carriage return. Run script through tr -d '\r' . |
| 396 | 1 | shellcheck | `1072` | ERROR | Here document was not correctly terminated. Fix any mentioned problems and try again. |

## Implementation Status

Items marked below as fixed:

## Fix Proposals

### 176 issues to fix

### Issue at Line 1

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## !/bin/bash
## Copyright (c) 2025 DebVisor contributors
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 2

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## !/bin/bash
## Copyright (c) 2025 DebVisor contributors
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 3

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## !/bin/bash
## Copyright (c) 2025 DebVisor contributors
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 4

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## !/bin/bash
## Copyright (c) 2025 DebVisor contributors
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
## Unless required by applicable law or agreed to in writing, software
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 5

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Copyright (c) 2025 DebVisor contributors
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 6

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 7

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 8

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## You may obtain a copy of the License at
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 9

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## [http://www.apache.org/licenses/LICENSE-2.0]([http://www.apache.org/licenses/LICENSE-2.]([http://www.apache.org/licenses/LICENSE-2]([http://www.apache.org/licenses/LICENSE-]([http://www.apache.org/licenses/LICENSE]([http://www.apache.org/licenses/LICENS]([http://www.apache.org/licenses/LICEN]([http://www.apache.org/licenses/LICE]([http://www.apache.org/licenses/LIC]([http://www.apache.org/licenses/LI]([http://www.apache.org/licenses/L]([http://www.apache.org/licenses/]([http://www.apache.org/licenses]([http://www.apache.org/license]([http://www.apache.org/licens](http://www.apache.org/licens)e)s)/)L)I)C)E)N)S)E)-)2).)0)
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 10

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 11

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.

## 
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 12

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.

## 
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 13

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## See the License for the specific language governing permissions and
## limitations under the License.

## 
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
## 
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 14

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## limitations under the License.

## 
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
## 
## This script validates blocklist functionality in a test environment
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 15

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## 
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
## 
## This script validates blocklist functionality in a test environment
## 1. Deploy blocklist and whitelist to test location
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 16

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## 
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
## 
## This script validates blocklist functionality in a test environment
## 1. Deploy blocklist and whitelist to test location
## 2. Verify firewall rules block/allow traffic correctly
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 17

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
## 
## This script validates blocklist functionality in a test environment
## 1. Deploy blocklist and whitelist to test location
## 2. Verify firewall rules block/allow traffic correctly
## 3. Test exception handling with whitelisted entries
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 18

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## blocklist-integration-tests.sh - Integration tests for blocklist deployment and enforcement
## 
## This script validates blocklist functionality in a test environment
## 1. Deploy blocklist and whitelist to test location
## 2. Verify firewall rules block/allow traffic correctly
## 3. Test exception handling with whitelisted entries
## 4. Validate smoke tests after deployment
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 19

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 
## This script validates blocklist functionality in a test environment
## 1. Deploy blocklist and whitelist to test location
## 2. Verify firewall rules block/allow traffic correctly
## 3. Test exception handling with whitelisted entries
## 4. Validate smoke tests after deployment
## 
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 20

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## This script validates blocklist functionality in a test environment
## 1. Deploy blocklist and whitelist to test location
## 2. Verify firewall rules block/allow traffic correctly
## 3. Test exception handling with whitelisted entries
## 4. Validate smoke tests after deployment
## 
## Requirements
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 21

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 1. Deploy blocklist and whitelist to test location
## 2. Verify firewall rules block/allow traffic correctly
## 3. Test exception handling with whitelisted entries
## 4. Validate smoke tests after deployment
## 
## Requirements
## - Python 3 with ipaddress module
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 22

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 2. Verify firewall rules block/allow traffic correctly
## 3. Test exception handling with whitelisted entries
## 4. Validate smoke tests after deployment
## 
## Requirements
## - Python 3 with ipaddress module
## - bash 4.0+
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 23

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 3. Test exception handling with whitelisted entries
## 4. Validate smoke tests after deployment
## 
## Requirements
## - Python 3 with ipaddress module
## - bash 4.0+
## - Optional: iptables/nftables for actual traffic testing
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 24

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 4. Validate smoke tests after deployment
## 
## Requirements
## - Python 3 with ipaddress module
## - bash 4.0+
## - Optional: iptables/nftables for actual traffic testing
## 
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 25

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 
## Requirements
## - Python 3 with ipaddress module
## - bash 4.0+
## - Optional: iptables/nftables for actual traffic testing
## 
## Usage
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 26

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Requirements
## - Python 3 with ipaddress module
## - bash 4.0+
## - Optional: iptables/nftables for actual traffic testing
## 
## Usage
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 27

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## - Python 3 with ipaddress module
## - bash 4.0+
## - Optional: iptables/nftables for actual traffic testing
## 
## Usage
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
## 
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 28

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## - bash 4.0+
## - Optional: iptables/nftables for actual traffic testing
## 
## Usage
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
## 

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 29

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## - Optional: iptables/nftables for actual traffic testing
## 
## Usage
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
## 

set -euo pipefail
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 30

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 
## Usage
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
## 

set -euo pipefail

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 31

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Usage
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
## 

set -euo pipefail

VERBOSE=false
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 32

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## ./blocklist-integration-tests.sh [--verbose] [--with-firewall]
## 

set -euo pipefail

VERBOSE=false
WITH_FIREWALL=false
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 33

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## 

set -euo pipefail

VERBOSE=false
WITH_FIREWALL=false
TEST_ENV="/tmp/debvisor-blocklist-test"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 34

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

set -euo pipefail

VERBOSE=false
WITH_FIREWALL=false
TEST_ENV="/tmp/debvisor-blocklist-test"
PASS_COUNT=0
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 35

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
set -euo pipefail

VERBOSE=false
WITH_FIREWALL=false
TEST_ENV="/tmp/debvisor-blocklist-test"
PASS_COUNT=0
FAIL_COUNT=0
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 36

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

VERBOSE=false
WITH_FIREWALL=false
TEST_ENV="/tmp/debvisor-blocklist-test"
PASS_COUNT=0
FAIL_COUNT=0

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 37

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
VERBOSE=false
WITH_FIREWALL=false
TEST_ENV="/tmp/debvisor-blocklist-test"
PASS_COUNT=0
FAIL_COUNT=0

## Colors
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 38

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
WITH_FIREWALL=false
TEST_ENV="/tmp/debvisor-blocklist-test"
PASS_COUNT=0
FAIL_COUNT=0

## Colors
RED='\033[0;31m'
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 39

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
TEST_ENV="/tmp/debvisor-blocklist-test"
PASS_COUNT=0
FAIL_COUNT=0

## Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 40

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
PASS_COUNT=0
FAIL_COUNT=0

## Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 41

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
FAIL_COUNT=0

## Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 42

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 43

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 44

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

log_info() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 45

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

log_info() {
  echo -e "${BLUE}[INFO]${NC} $*"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 46

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

log_info() {
  echo -e "${BLUE}[INFO]${NC} $*"
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 47

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
BLUE='\033[0;34m'
NC='\033[0m'

log_info() {
  echo -e "${BLUE}[INFO]${NC} $*"
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 48

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
NC='\033[0m'

log_info() {
  echo -e "${BLUE}[INFO]${NC} $*"
}

log_pass() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 49

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

log_info() {
  echo -e "${BLUE}[INFO]${NC} $*"
}

log_pass() {
  echo -e "${GREEN}[PASS]${NC} $*"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 50

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
log_info() {
  echo -e "${BLUE}[INFO]${NC} $*"
}

log_pass() {
  echo -e "${GREEN}[PASS]${NC} $*"
  ((PASS_COUNT++))
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 51

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  echo -e "${BLUE}[INFO]${NC} $*"
}

log_pass() {
  echo -e "${GREEN}[PASS]${NC} $*"
  ((PASS_COUNT++))
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 52

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

log_pass() {
  echo -e "${GREEN}[PASS]${NC} $*"
  ((PASS_COUNT++))
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 53

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

log_pass() {
  echo -e "${GREEN}[PASS]${NC} $*"
  ((PASS_COUNT++))
}

log_fail() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 54

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
log_pass() {
  echo -e "${GREEN}[PASS]${NC} $*"
  ((PASS_COUNT++))
}

log_fail() {
  echo -e "${RED}[FAIL]${NC} $*"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 55

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  echo -e "${GREEN}[PASS]${NC} $*"
  ((PASS_COUNT++))
}

log_fail() {
  echo -e "${RED}[FAIL]${NC} $*"
  ((FAIL_COUNT++))
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 56

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  ((PASS_COUNT++))
}

log_fail() {
  echo -e "${RED}[FAIL]${NC} $*"
  ((FAIL_COUNT++))
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 57

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

log_fail() {
  echo -e "${RED}[FAIL]${NC} $*"
  ((FAIL_COUNT++))
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 58

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

log_fail() {
  echo -e "${RED}[FAIL]${NC} $*"
  ((FAIL_COUNT++))
}

log_warn() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 59

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
log_fail() {
  echo -e "${RED}[FAIL]${NC} $*"
  ((FAIL_COUNT++))
}

log_warn() {
  echo -e "${YELLOW}[WARN]${NC} $*"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 60

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  echo -e "${RED}[FAIL]${NC} $*"
  ((FAIL_COUNT++))
}

log_warn() {
  echo -e "${YELLOW}[WARN]${NC} $*"
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 61

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  ((FAIL_COUNT++))
}

log_warn() {
  echo -e "${YELLOW}[WARN]${NC} $*"
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 62

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

log_warn() {
  echo -e "${YELLOW}[WARN]${NC} $*"
}

log_verbose() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 63

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

log_warn() {
  echo -e "${YELLOW}[WARN]${NC} $*"
}

log_verbose() {
  if [["$VERBOSE" == "true"]]; then
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 64

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
log_warn() {
  echo -e "${YELLOW}[WARN]${NC} $*"
}

log_verbose() {
  if [["$VERBOSE" == "true"]]; then
    echo -e "${BLUE}[VERBOSE]${NC} $*"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 65

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  echo -e "${YELLOW}[WARN]${NC} $*"
}

log_verbose() {
  if [["$VERBOSE" == "true"]]; then
    echo -e "${BLUE}[VERBOSE]${NC} $*"
  fi
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 66

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

log_verbose() {
  if [["$VERBOSE" == "true"]]; then
    echo -e "${BLUE}[VERBOSE]${NC} $*"
  fi
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 67

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

log_verbose() {
  if [["$VERBOSE" == "true"]]; then
    echo -e "${BLUE}[VERBOSE]${NC} $*"
  fi
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 68

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
log_verbose() {
  if [["$VERBOSE" == "true"]]; then
    echo -e "${BLUE}[VERBOSE]${NC} $*"
  fi
}

## Parse arguments
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 69

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  if [["$VERBOSE" == "true"]]; then
    echo -e "${BLUE}[VERBOSE]${NC} $*"
  fi
}

## Parse arguments
while [[$# -gt 0]]; do
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 70

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    echo -e "${BLUE}[VERBOSE]${NC} $*"
  fi
}

## Parse arguments
while [[$# -gt 0]]; do
  case "$1" in
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 71

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  fi
}

## Parse arguments
while [[$# -gt 0]]; do
  case "$1" in
    --verbose) VERBOSE=true; shift ;;
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 72

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

## Parse arguments
while [[$# -gt 0]]; do
  case "$1" in
    --verbose) VERBOSE=true; shift ;;
    --with-firewall) WITH_FIREWALL=true; shift ;;
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 73

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## Parse arguments
while [[$# -gt 0]]; do
  case "$1" in
    --verbose) VERBOSE=true; shift ;;
    --with-firewall) WITH_FIREWALL=true; shift ;;
    *) echo "Unknown option: $1"; exit 1 ;;
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 74

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Parse arguments
while [[$# -gt 0]]; do
  case "$1" in
    --verbose) VERBOSE=true; shift ;;
    --with-firewall) WITH_FIREWALL=true; shift ;;
    *) echo "Unknown option: $1"; exit 1 ;;
  esac
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 75

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
while [[$# -gt 0]]; do
  case "$1" in
    --verbose) VERBOSE=true; shift ;;
    --with-firewall) WITH_FIREWALL=true; shift ;;
    *) echo "Unknown option: $1"; exit 1 ;;
  esac
done
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 76

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  case "$1" in
    --verbose) VERBOSE=true; shift ;;
    --with-firewall) WITH_FIREWALL=true; shift ;;
    *) echo "Unknown option: $1"; exit 1 ;;
  esac
done

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 77

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    --verbose) VERBOSE=true; shift ;;
    --with-firewall) WITH_FIREWALL=true; shift ;;
    *) echo "Unknown option: $1"; exit 1 ;;
  esac
done

## Setup test environment
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 78

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    --with-firewall) WITH_FIREWALL=true; shift ;;
    *) echo "Unknown option: $1"; exit 1 ;;
  esac
done

## Setup test environment
setup_test_env() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 79

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    *) echo "Unknown option: $1"; exit 1 ;;
  esac
done

## Setup test environment
setup_test_env() {
  log_info "Setting up test environment..."
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 80

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  esac
done

## Setup test environment
setup_test_env() {
  log_info "Setting up test environment..."
  rm -rf "$TEST_ENV"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 81

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
done

## Setup test environment
setup_test_env() {
  log_info "Setting up test environment..."
  rm -rf "$TEST_ENV"
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 82

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## Setup test environment
setup_test_env() {
  log_info "Setting up test environment..."
  rm -rf "$TEST_ENV"
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 83

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Setup test environment
setup_test_env() {
  log_info "Setting up test environment..."
  rm -rf "$TEST_ENV"
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}

  # Copy example files
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 84

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
setup_test_env() {
  log_info "Setting up test environment..."
  rm -rf "$TEST_ENV"
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}

  # Copy example files
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 85

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  log_info "Setting up test environment..."
  rm -rf "$TEST_ENV"
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}

  # Copy example files
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 86

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  rm -rf "$TEST_ENV"
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}

  # Copy example files
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
    log_verbose "Copied blocklist to test environment"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 87

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  mkdir -p "$TEST_ENV"/{blocklists,whitelists,results}

  # Copy example files
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
    log_verbose "Copied blocklist to test environment"
  fi
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 88

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

  # Copy example files
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
    log_verbose "Copied blocklist to test environment"
  fi

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 89

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  # Copy example files
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
    log_verbose "Copied blocklist to test environment"
  fi

  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 90

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  if [[-f "etc/debvisor/blocklist-example.txt"]]; then
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
    log_verbose "Copied blocklist to test environment"
  fi

  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 91

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    cp "etc/debvisor/blocklist-example.txt" "$TEST_ENV/blocklists/test-blocklist.txt"
    log_verbose "Copied blocklist to test environment"
  fi

  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
    log_verbose "Copied whitelist to test environment"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 92

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    log_verbose "Copied blocklist to test environment"
  fi

  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
    log_verbose "Copied whitelist to test environment"
  fi
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 93

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  fi

  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
    log_verbose "Copied whitelist to test environment"
  fi
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 94

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
    log_verbose "Copied whitelist to test environment"
  fi
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 95

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  if [[-f "etc/debvisor/blocklist-whitelist-example.txt"]]; then
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
    log_verbose "Copied whitelist to test environment"
  fi
}

## Test 1: Blocklist can be read and parsed
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 96

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    cp "etc/debvisor/blocklist-whitelist-example.txt" "$TEST_ENV/whitelists/test-whitelist.txt"
    log_verbose "Copied whitelist to test environment"
  fi
}

## Test 1: Blocklist can be read and parsed
test_blocklist_parsing() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 97

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    log_verbose "Copied whitelist to test environment"
  fi
}

## Test 1: Blocklist can be read and parsed
test_blocklist_parsing() {
  log_info "Test 1: Blocklist parsing..."
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 98

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  fi
}

## Test 1: Blocklist can be read and parsed
test_blocklist_parsing() {
  log_info "Test 1: Blocklist parsing..."

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 99

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

## Test 1: Blocklist can be read and parsed
test_blocklist_parsing() {
  log_info "Test 1: Blocklist parsing..."

  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 100

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## Test 1: Blocklist can be read and parsed
test_blocklist_parsing() {
  log_info "Test 1: Blocklist parsing..."

  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
    log_fail "Blocklist file not found"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 101

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Test 1: Blocklist can be read and parsed
test_blocklist_parsing() {
  log_info "Test 1: Blocklist parsing..."

  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
    log_fail "Blocklist file not found"
    return 1
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 102

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
test_blocklist_parsing() {
  log_info "Test 1: Blocklist parsing..."

  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
    log_fail "Blocklist file not found"
    return 1
  fi
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 103

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  log_info "Test 1: Blocklist parsing..."

  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
    log_fail "Blocklist file not found"
    return 1
  fi

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 104

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
    log_fail "Blocklist file not found"
    return 1
  fi

  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 105

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  if [[! -f "$TEST_ENV/blocklists/test-blocklist.txt"]]; then
    log_fail "Blocklist file not found"
    return 1
  fi

  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 106

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    log_fail "Blocklist file not found"
    return 1
  fi

  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')

  if [[$entry_count -gt 0]]; then
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 107

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    return 1
  fi

  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')

  if [[$entry_count -gt 0]]; then
    log_pass "Blocklist contains $entry_count valid entries"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 108

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  fi

  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')

  if [[$entry_count -gt 0]]; then
    log_pass "Blocklist contains $entry_count valid entries"
    return 0
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 109

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')

  if [[$entry_count -gt 0]]; then
    log_pass "Blocklist contains $entry_count valid entries"
    return 0
  else
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 110

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  local entry_count=$(grep -v '^[[:space:]]*$' "$TEST_ENV/blocklists/test-blocklist.txt" | grep -c -v '^[[:space:]]*#')

  if [[$entry_count -gt 0]]; then
    log_pass "Blocklist contains $entry_count valid entries"
    return 0
  else
    log_fail "Blocklist contains no valid entries"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 111

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

  if [[$entry_count -gt 0]]; then
    log_pass "Blocklist contains $entry_count valid entries"
    return 0
  else
    log_fail "Blocklist contains no valid entries"
    return 1
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 112

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  if [[$entry_count -gt 0]]; then
    log_pass "Blocklist contains $entry_count valid entries"
    return 0
  else
    log_fail "Blocklist contains no valid entries"
    return 1
  fi
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 113

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    log_pass "Blocklist contains $entry_count valid entries"
    return 0
  else
    log_fail "Blocklist contains no valid entries"
    return 1
  fi
}
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 114

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    return 0
  else
    log_fail "Blocklist contains no valid entries"
    return 1
  fi
}

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 115

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  else
    log_fail "Blocklist contains no valid entries"
    return 1
  fi
}

## Test 2: All blocklist entries are valid CIDR format
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 116

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    log_fail "Blocklist contains no valid entries"
    return 1
  fi
}

## Test 2: All blocklist entries are valid CIDR format
test_blocklist_syntax() {
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 117

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    return 1
  fi
}

## Test 2: All blocklist entries are valid CIDR format
test_blocklist_syntax() {
  log_info "Test 2: Blocklist syntax validation..."
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 118

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  fi
}

## Test 2: All blocklist entries are valid CIDR format
test_blocklist_syntax() {
  log_info "Test 2: Blocklist syntax validation..."

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 119

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
}

## Test 2: All blocklist entries are valid CIDR format
test_blocklist_syntax() {
  log_info "Test 2: Blocklist syntax validation..."

  local invalid_count=0
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 120

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## Test 2: All blocklist entries are valid CIDR format
test_blocklist_syntax() {
  log_info "Test 2: Blocklist syntax validation..."

  local invalid_count=0
  while IFS= read -r line; do
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 121

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Test 2: All blocklist entries are valid CIDR format
test_blocklist_syntax() {
  log_info "Test 2: Blocklist syntax validation..."

  local invalid_count=0
  while IFS= read -r line; do
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 122

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
test_blocklist_syntax() {
  log_info "Test 2: Blocklist syntax validation..."

  local invalid_count=0
  while IFS= read -r line; do
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 123

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  log_info "Test 2: Blocklist syntax validation..."

  local invalid_count=0
  while IFS= read -r line; do
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue

    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 124

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

  local invalid_count=0
  while IFS= read -r line; do
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue

    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
    [[-z "$entry"]] && continue
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 125

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  local invalid_count=0
  while IFS= read -r line; do
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue

    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
    [[-z "$entry"]] && continue

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 126

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
  while IFS= read -r line; do
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue

    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
    [[-z "$entry"]] && continue

    if ! python3 -c "from ipaddress import ip_network; ip_network('$entry', strict=False)" 2>/dev/null; then
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 127

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    [[-z "$line" || "$line" =~ ^[[:space:]]*#]] && continue

    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
    [[-z "$entry"]] && continue

    if ! python3 -c "from ipaddress import ip_network; ip_network('$entry', strict=False)" 2>/dev/null; then
      log_verbose "Invalid entry: $entry"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 128

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
    [[-z "$entry"]] && continue

    if ! python3 -c "from ipaddress import ip_network; ip_network('$entry', strict=False)" 2>/dev/null; then
      log_verbose "Invalid entry: $entry"
      ((invalid_count++))
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 129

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    local entry=$(echo "$line" | sed 's/#.*//' | xargs)
    [[-z "$entry"]] && continue

    if ! python3 -c "from ipaddress import ip_network; ip_network('$entry', strict=False)" 2>/dev/null; then
      log_verbose "Invalid entry: $entry"
      ((invalid_count++))
    fi
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 130

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
    [[-z "$entry"]] && continue

    if ! python3 -c "from ipaddress import ip_network; ip_network('$entry', strict=False)" 2>/dev/null; then
      log_verbose "Invalid entry: $entry"
      ((invalid_count++))
    fi
  done /dev/null; then
      log_verbose "Invalid entry: $entry"
      ((invalid_count++))
    fi
  done /dev/null; then
      log_verbose "Invalid entry: $entry"
      ((invalid_count++))
    fi
  done  "$TEST_ENV/results/whitelist-test.json" 2>&1
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 166

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python

## Test 4: Whitelist exceptions override blocklist entries
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 167

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
## Test 4: Whitelist exceptions override blocklist entries
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1009` |**Severity:** INFO

**Message:** The mentioned syntax error was in this simple command.

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1073` |**Severity:** ERROR

**Message:** Couldn't parse this here document. Fix to allow more checks.

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1041` |**Severity:** ERROR

**Message:** Found 'PYEOF' further down, but not on a separate line.

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1042` |**Severity:** ERROR

**Message:** Close matches include '  python3  "$TEST_ENV/results/dual-stack-test.json" 2>&1\r' (!= 'PYEOF').

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1042` |**Severity:** ERROR

**Message:** Close matches include '  python3  "$TEST_ENV/results/overlap-test.json" 2>&1\r' (!= 'PYEOF').

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1042` |**Severity:** ERROR

**Message:** Close matches include '  python3  /dev/null 2>&1\r' (!= 'PYEOF').

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1042` |**Severity:** ERROR

**Message:** Close matches include 'PYEOF\r' (!= 'PYEOF').

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 168

**Tool:**shellcheck |**Code:**`1017` |**Severity:** ERROR

**Message:** Literal carriage return. Run script through tr -d '\r' .

### Context

```python
test_whitelist_exceptions() {
  log_info "Test 4: Whitelist exception handling..."

  python3  "$TEST_ENV/results/whitelist-test.json" 2>&1
import json
from ipaddress import ip_network

```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

### Issue at Line 396

**Tool:**shellcheck |**Code:**`1072` |**Severity:** ERROR

**Message:** Here document was not correctly terminated. Fix any mentioned problems and try again.

### Context

```python

## Run main
main "$@"
```python

### Proposal

- Review the issue message above

- Consider the context code

- Apply the appropriate fix (e.g., fix linting error, add type hints, improve security)

- Ensure the fix aligns with the codebase style and the context.md guidelines

---

## Implementation Progress

To mark an issue as fixed, add the issue code to the line below with a  emoji:

**Fixed Issues:** (none yet)

---
*Updated: (auto-populated by coding expert)*
