# Three-Agent Code Quality System\n\n## Overview\n\nThe DebVisor project now includes a comprehensive three-agent code quality and structure validation system:\n\n1. **Planning Agent** - Validates file structure and organization\n1. **Critic Agent** - Detects code quality issues\n1. **Coding Expert Agent** - Proposes fixes and tracks implementation\n1. **Unified Workflow** - Orchestrates all three agents\n\n## Components\n\n### 1. Planning Agent (`planning_agent.py`)\n\n**Purpose:** Ensures every code file follows the required structure.\n\n**Validates:**\n\n- License header (Apache 2.0, properly formatted as comments)\n- Module docstring with required sections:\n- Description\n  - Changelog\n  - Suggested Fixes\n  - Improvements\n- File organization (shebang, proper ordering)\n\n**Output:** `filename.ext.plan.md` - Structure validation reports with fix proposals\n\n**Supported Files:** `.py`, `.sh`, `.js`, `.ts`, `.go`, `.rb`\n\n**Run:**\n\n```bash\npython3 scripts/planning_agent.py\n\n```text\n\n### 2. Critic Agent (`critic_agent.py`)\n\n**Purpose:** Detects code quality issues using integrated linters.\n\n**Tools Used:**\n\n- **Python:** flake8 (style), mypy (types), bandit (security)\n- **Shell:** shellcheck (syntax), bandit (security)\n- **JavaScript:** eslint\n- **CSS:** stylelint\n- **HTML:** htmlhint\n- **Go:** golangci-lint\n\n**Output:** `filename.ext.md` - Issue reports with severity levels\n\n**Run:**\n\n```bash\npython3 scripts/critic_agent.py\n\n```text\n\n### 3. Coding Expert Agent (`coding_expert_agent.py`)\n\n**Purpose:** Analyzes issue reports and generates detailed fix proposals.\n\n**Input:** `filename.ext.md` reports from Critic Agent\n\n**Output:** Enhanced `.md` files with:\n\n- Issue analysis\n- Code context\n- Fix proposals\n- Implementation status tracking (✅ emoji markers)\n\n**Run:**\n\n```bash\npython3 scripts/coding_expert_agent.py\n\n```text\n\n### 4. Unified Workflow (`unified_workflow.py`)\n\n**Purpose:** Orchestrates all three agents in sequence with status reporting.\n\n**Execution Flow:**\n\n1. Planning Agent validates structure\n1. Critic Agent detects issues\n1. Coding Expert Agent proposes fixes\n1. Summary report with next steps\n\n**Run:**\n\n```bash\npython3 scripts/unified_workflow.py\n\n```text\n\n## File Structure Template\n\nEach code file should follow this structure:\n\n```python\n#!/usr/bin/env python3\n# Copyright (c) 2025 DebVisor contributors\n# Licensed under the Apache License, Version 2.0 (the "License");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#     http://www.apache.org/licenses/LICENSE-2.0\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an "AS IS" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n"""\nModule description - brief explanation of purpose.\n\n## Description\nDetailed description of what this module does, its functionality,\nand how it fits into the overall system.\n\n## Changelog\n- 1.0.0: Initial release\n- 1.1.0: Added feature X\n- 1.2.0: Fixed bug Y\n\n## Suggested Fixes\n- Performance optimization needed for large datasets\n- Add support for streaming input\n- Implement caching layer\n\n## Improvements\n- Add comprehensive logging\n- Implement parallel processing\n- Add type hints to all functions\n"""\n\n# =====================================================\n# Implementation\n# ===================================================== (2)\n\nimport sys\nfrom pathlib import Path\n\ndef main():\n    """Main entry point."""\n    pass\n\nif __name__ == '__main__':\n    main()\n\n```text\n\n## Usage Workflow\n\n### Step 1: Run Full Workflow\n\n```bash\npython3 scripts/unified_workflow.py\n\n```text\n\nThis will:\n\n- Validate file structure across all code files\n- Detect code quality issues\n- Generate fix proposals\n\n### Step 2: Review Generated Reports\n\n**For Structure Issues:**\n\n- Check `filename.ext.plan.md` files\n- Follow fix proposals to restructure files\n\n**For Code Issues:**\n\n- Check `filename.ext.md` files\n- Review fix proposals in Coding Expert reports\n\n### Step 3: Implement Fixes\n\nModify source files to:\n\n1. Fix file structure (if needed)\n1. Implement code quality fixes\n1. Update documentation sections\n\n### Step 4: Mark Issues as Fixed\n\nIn the `.md` and `.plan.md` files, mark completed fixes:\n\n```markdown\n## Implementation Status\n✅ `E501` - Line too long (fixed)\n✅ `missing_description` - Added description section\n\n```text\n\n### Step 5: Re-run Workflow\n\nRun the workflow again to verify fixes and detect new issues:\n\n```bash\npython3 scripts/unified_workflow.py\n\n```text\n\n## Output Structure\n\n```text\nrepository/\n├── scripts/\n│   ├── planning_agent.py\n│   ├── critic_agent.py\n│   ├── coding_expert_agent.py\n│   ├── unified_workflow.py\n│   ├── PLANNING_AGENT_README.md\n│   ├── CRITIC_WORKFLOW_README.md\n│   └── README.md (this file)\n│\n├── opt/\n│   ├── __init__.py\n│   ├── __init__.py.plan.md       (structure validation)\n│   ├── __init__.py.md            (code issues)\n│   ├── services/\n│   │   ├── api.py\n│   │   ├── api.py.plan.md\n│   │   └── api.py.md\n│   └── ...\n│\n└── docs/\n    ├── CODE_OF_CONDUCT.md\n    ├── CONTRIBUTING.md\n    └── ...\n\n```text\n\n## Integration Points\n\n### With Version Control\n\n- Run workflow before committing\n- Review generated `.md` reports\n- Commit fixes with clear messages referencing issue codes\n\n### With CI/CD Pipeline\n\n```yaml\n# Example GitHub Actions\n- name: Run Quality Workflow\n  run: python3 scripts/unified_workflow.py\n\n- name: Check for Quality Issues\n  run: |\n    if ls *.plan.md *.md 2>/dev/null | grep -q .; then\n      echo "Quality issues found - review reports"\n      exit 1\n    fi\n\n```text\n\n### With Code Review\n\n- Use generated reports in pull request discussions\n- Reference specific issue codes (E501, missing-section, etc.)\n- Link to fix proposals in reports\n\n## Agent Architecture\n\n```text\n┌─────────────────────────────────────────────┐\n│        Unified Workflow Driver              │\n└────────────────┬────────────────────────────┘\n                 │\n       ┌─────────┼─────────┐\n       ▼         ▼         ▼\n  Planning    Critic    Coding\n   Agent      Agent     Expert\n   Agent      Agent     Agent\n       │         │         │\n       ▼         ▼         ▼\n   .plan.md   .md     Enhanced\n   reports   reports  .md files\n       │         │         │\n       └─────────┴─────────┘\n              │\n              ▼\n    Developer Reviews &\n    Implements Fixes\n              │\n              ▼\n      Re-run Workflow\n\n```text\n\n## Best Practices\n\n1. **Structure Files Early**\n\n   - Ensure proper structure before worrying about code quality\n   - Use `.plan.md` reports to fix structure issues first\n\n1. **Address Issues Systematically**\n\n   - Fix critical issues (security, type errors) first\n   - Then address style and formatting\n\n1. **Update Documentation Sections**\n\n   - Keep Changelog current with changes\n   - List realistic improvements in Improvements section\n   - Document issues in Suggested Fixes\n\n1. **Mark Progress**\n\n   - Use ✅ emoji to track implementation\n   - Don't just delete issues - mark them as complete\n\n1. **Regular Runs**\n\n   - Run workflow before commits\n   - Run after major refactoring\n   - Use in CI/CD pipeline\n\n## Troubleshooting\n\n### Planning Agent Issues\n\n**"Missing license header line"**\n\n- Check exact formatting of license header\n- Verify comment character is correct for file type\n- All 10 lines must be present\n\n**"Missing section"**\n\n- Ensure all 4 sections in docstring: Description, Changelog, Suggested Fixes, Improvements\n- Check spelling and capitalization\n\n### Critic Agent Issues\n\n**"Tool not found"**\n\n```bash\n# Install missing linters\npip install flake8 mypy bandit\nnpm install -g eslint stylelint\nbrew install shellcheck\n\n```text\n\n**No issues generated**\n\n- Code quality is excellent ✅\n- Tools may be timing out (increase timeout parameter)\n- Check tools are in PATH\n\n### Coding Expert Agent Issues\n\n**"No reports found"**\n\n- Run Critic Agent first to generate `.md` files\n- Check output directory contains `.md` files\n\n## Contributing\n\nWhen modifying the agent system:\n\n1. Update relevant README files\n1. Test with sample code files\n1. Update this file with changes\n1. Ensure all agents pass flake8\n1. Document in context.md and changelog.md\n\n## Files Included\n\n| File | Purpose |\n|------|---------|\n| `planning_agent.py` | File structure validation |\n| `critic_agent.py` | Code quality analysis |\n| `coding_expert_agent.py` | Fix proposal generation |\n| `unified_workflow.py` | Workflow orchestration |\n| `PLANNING_AGENT_README.md` | Detailed planning agent docs |\n| `CRITIC_WORKFLOW_README.md` | Detailed critic agent docs |\n| This file | Overview and usage guide |\n\n## Version History\n\n- **1.0.0** (December 13, 2025)\n- Initial release with three-agent system\n  - Planning Agent for structure validation\n  - Critic Agent with 7 integrated linters\n  - Coding Expert Agent with proposal generation\n  - Unified Workflow orchestrator\n\n## Next Steps\n\n1. Run `python3 scripts/unified_workflow.py` to analyze codebase\n1. Review generated `.plan.md` and `.md` reports\n1. Implement fixes following proposals\n1. Mark completed items with ✅\n1. Re-run workflow to verify improvements\n
